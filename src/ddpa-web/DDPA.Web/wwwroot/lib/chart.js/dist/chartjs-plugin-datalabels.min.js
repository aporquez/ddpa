/*!
 * @license
 * chartjs-plugin-datalabels
 * http://chartjs.org/
 * Version: 0.5.0
 *
 * Copyright 2018 Chart.js Contributors
 * Released under the MIT license
 * https://github.com/chartjs/chartjs-plugin-datalabels/blob/master/LICENSE.md
 */
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("chart.js")):typeof define=="function"&&define.amd?define(["chart.js"],t):n.ChartDataLabels=t(n.Chart)})(this,function(n){"use strict";function v(n,t){var f=t.x,e=t.y;if(f===null)return{x:0,y:-1};if(e===null)return{x:1,y:0};var r=n.x-f,u=n.y-e,i=Math.sqrt(r*r+u*u);return{x:i?r/i:0,y:i?u/i:-1}}function et(n,t,i,r,u){switch(u){case"center":i=r=0;break;case"bottom":i=0;r=1;break;case"right":i=1;r=0;break;case"left":i=-1;r=0;break;case"top":i=0;r=-1;break;case"start":i=-i;r=-r;break;case"end":break;default:u*=Math.PI/180;i=Math.cos(u);r=Math.sin(u)}return{x:n,y:t,vx:i,vy:r}}function s(n,t,i){var r=ot;return n<i.left?r|=g:n>i.right&&(r|=nt),t<i.top?r|=it:t>i.bottom&&(r|=tt),r}function st(n,t){for(var i=n.x0,r=n.y0,u=n.x1,f=n.y1,c=s(i,r,t),l=s(u,f,t),e,o,h;;){if(!(c|l)||c&l)break;e=c||l;e&it?(o=i+(u-i)*(t.top-r)/(f-r),h=t.top):e&tt?(o=i+(u-i)*(t.bottom-r)/(f-r),h=t.bottom):e&nt?(h=r+(f-r)*(t.right-i)/(u-i),o=t.right):e&g&&(h=r+(f-r)*(t.left-i)/(u-i),o=t.left);e===c?(i=o,r=h,c=s(i,r,t)):(u=o,f=h,l=s(u,f,t))}return{x0:i,x1:u,y0:r,y1:f}}function h(n,t){var f=t.anchor,i=n,r,u;return t.clamp&&(i=st(i,t.area)),f==="start"?(r=i.x0,u=i.y0):f==="end"?(r=i.x1,u=i.y1):(r=(i.x0+i.x1)/2,u=(i.y0+i.y1)/2),et(r,u,n.vx,n.vy,t.align)}function ht(n){var t=n.borderWidth||0,i=n.padding,r=n.size.height,u=n.size.width,f=-u/2,e=-r/2;return{frame:{x:f-i.left-t,y:e-i.top-t,w:u+i.width+t*2,h:r+i.height+t*2},text:{x:f,y:e,w:u,h:r}}}function ct(n){var r=n._model.horizontal,t=n._scale||r&&n._xScale||n._yScale,i;return t?t.xCenter!==undefined&&t.yCenter!==undefined?{x:t.xCenter,y:t.yCenter}:(i=t.getBasePixel(),r?{x:i,y:null}:{x:null,y:i}):null}function lt(t){return t instanceof n.elements.Arc?c.arc:t instanceof n.elements.Point?c.point:t instanceof n.elements.Rectangle?c.rect:c.fallback}function at(n,t,r){var e=r.backgroundColor,o=r.borderColor,f=r.borderWidth;(e||o&&f)&&(n.beginPath(),u.canvas.roundedRect(n,i(t.x)+f/2,i(t.y)+f/2,i(t.w)-f,i(t.h)-f,r.borderRadius),n.closePath(),e&&(n.fillStyle=e,n.fill()),o&&f&&(n.strokeStyle=o,n.lineWidth=f,n.lineJoin="miter",n.stroke()))}function vt(n,t,i){var f=i.lineHeight,r=n.w,u=n.x,e=n.y+f/2;return t==="center"?u+=r/2:(t==="end"||t==="right")&&(u+=r),{h:f,w:r,x:u,y:e}}function yt(n,t,r){var u=n.shadowBlur,f=r.stroked,e=i(r.x),o=i(r.y),s=i(r.w);f&&n.strokeText(t,e,o,s);r.filled&&(u&&f&&(n.shadowBlur=0),n.fillText(t,e,o,s),u&&f&&(n.shadowBlur=u))}function pt(n,t,i,r){var s=r.textAlign,h=r.color,f=!!h,c=r.font,e=t.length,l=r.textStrokeColor,a=r.textStrokeWidth,o=l&&a,u;if(e&&(f||o))for(i=vt(i,s,c),n.font=c.string,n.textAlign=s,n.textBaseline="middle",n.shadowBlur=r.textShadowBlur,n.shadowColor=r.textShadowColor,f&&(n.fillStyle=h),o&&(n.lineJoin="round",n.lineWidth=a,n.strokeStyle=l),u=0,e=t.length;u<e;++u)yt(n,t[u],{stroked:o,filled:f,w:i.w,x:i.x,y:i.y+i.h*u})}function e(n,t,i){var f=Math.cos(i),e=Math.sin(i),r=t.x,u=t.y;return{x:r+f*(n.x-r)-e*(n.y-u),y:u+e*(n.x-r)+f*(n.y-u)}}function rt(n,t){for(var r=kt,u=bt,o=t.origin,f,s,h,e,i=0;i<n.length;++i)f=n[i],s=f.x-o.x,h=f.y-o.y,e=t.vx*s+t.vy*h,r=Math.min(r,e),u=Math.max(u,e);return{min:r,max:u}}function l(n,t){var r=t.x-n.x,u=t.y-n.y,i=Math.sqrt(r*r+u*u);return{vx:(t.x-n.x)/i,vy:(t.y-n.y)/i,origin:n,ln:i}}function ut(n,t,i){var r=t.positioner(n,t),u=r.vx,f=r.vy;if(!u&&!f)return{x:r.x,y:r.y};var h=i.w,c=i.h,e=t.rotation,o=Math.abs(h/2*Math.cos(e))+Math.abs(c/2*Math.sin(e)),s=Math.abs(h/2*Math.sin(e))+Math.abs(c/2*Math.cos(e)),l=1/Math.max(Math.abs(u),Math.abs(f));return o*=u*l,s*=f*l,o+=t.offset*u,s+=t.offset*f,{x:r.x+o,y:r.y+s}}function dt(n,t){for(var r,u,f,i=n.length-1;i>=0;--i)for(u=n[i].$layout,r=i-1;r>=0&&u._visible;--r)f=n[r].$layout,f._visible&&u._box.intersects(f._box)&&t(u,f);return n}function gt(n){for(var t,r,u,e,i=0,f=n.length;i<f;++i)t=n[i],r=t.$layout,r._visible&&(u=t.geometry(),e=ut(t._el._model,t.model(),u),r._box.update(e,u,t.rotation()));return dt(n,function(n,t){var i=n._hidable,r=t._hidable;i&&r||r?t._visible=!1:i&&(n._visible=!1)})}function ni(n,t){var i=n.datalabels;return i===!1?null:(i===!0&&(i={}),w.merge({},[t,i]))}function b(n,i,r){var e=i&&i[r.dataset],u,f;e&&(u=r.label,f=u.$context,w.callback(e,[f])===!0&&(n[t]._dirty=!0,u.update(f)))}function ti(n,t,i,r){var u,f;(i||r)&&(i?r?i.label!==r.label&&(f=u=!0):f=!0:u=!0,f&&b(n,t.leave,i),u&&b(n,t.enter,r))}function ii(n,i){var r=n[t],u=r._listeners,e,f;if(u.enter||u.leave){if(i.type==="mousemove")f=o.lookup(r._labels,i);else if(i.type!=="mouseout")return;e=r._hovered;r._hovered=f;ti(n,u,e,f)}}function ri(n,i){var r=n[t],u=r._listeners.click,f=u&&o.lookup(r._labels,i);f&&b(n,u,f)}var y,p,k;n=n&&n.hasOwnProperty("default")?n["default"]:n;var r=n.helpers,d=function(){if(typeof window!="undefined"){if(window.devicePixelRatio)return window.devicePixelRatio;var n=window.screen;if(n)return(n.deviceXDPI||1)/(n.logicalXDPI||1)}return 1}(),f={toTextLines:function(n){var i=[],t;for(n=[].concat(n);n.length;)t=n.pop(),typeof t=="string"?i.unshift.apply(i,t.split("\n")):Array.isArray(t)?n.push.apply(n,t):r.isNullOrUndef(n)||i.unshift(""+t);return i},toFontString:function(n){return!n||r.isNullOrUndef(n.size)||r.isNullOrUndef(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family},textSize:function(n,t,i){var f=[].concat(t),e=f.length,o=n.font,u=0,r;for(n.font=i.string,r=0;r<e;++r)u=Math.max(n.measureText(f[r]).width,u);return n.font=o,{height:e*i.lineHeight,width:u}},parseFont:function(t){var i=n.defaults.global,e=r.valueOrDefault(t.size,i.defaultFontSize),u={family:r.valueOrDefault(t.family,i.defaultFontFamily),lineHeight:r.options.toLineHeight(t.lineHeight,e),size:e,style:r.valueOrDefault(t.style,i.defaultFontStyle),weight:r.valueOrDefault(t.weight,null),string:""};return u.string=f.toFontString(u),u},bound:function(n,t,i){return Math.max(n,Math.min(t,i))},arrayDiff:function(n,t){for(var r=n.slice(),f=[],e,o,i=0,u=t.length;i<u;++i)o=t[i],e=r.indexOf(o),e===-1?f.push([o,1]):r.splice(e,1);for(i=0,u=r.length;i<u;++i)f.push([r[i],-1]);return f},rasterize:function(n){return Math.round(n*d)/d}};var ot=0,g=1,nt=2,tt=4,it=8;var c={arc:function(n,t){var u=(n.startAngle+n.endAngle)/2,i=Math.cos(u),r=Math.sin(u),f=n.innerRadius,e=n.outerRadius;return h({x0:n.x+i*f,y0:n.y+r*f,x1:n.x+i*e,y1:n.y+r*e,vx:i,vy:r},t)},point:function(n,t){var i=v(n,t.origin),r=i.x*n.radius,u=i.y*n.radius;return h({x0:n.x-r,y0:n.y-u,x1:n.x+r,y1:n.y+u,vx:i.x,vy:i.y},t)},rect:function(n,t){var u=v(n,t.origin),i=n.x,r=n.y,f=0,e=0;return n.horizontal?(i=Math.min(n.x,n.base),f=Math.abs(n.base-n.x)):(r=Math.min(n.y,n.base),e=Math.abs(n.base-n.y)),h({x0:i,y0:r+e,x1:i+f,y1:r,vx:u.x,vy:u.y},t)},fallback:function(n,t){var i=v(n,t.origin);return h({x0:n.x,y0:n.y,x1:n.x,y1:n.y,vx:i.x,vy:i.y},t)}},u=n.helpers,i=f.rasterize;y=function(n,t,i,r){var u=this;u._config=n;u._index=r;u._model=null;u._rects=null;u._ctx=t;u._el=i};u.extend(y.prototype,{_modelize:function(t,i,r,e){var h=this,o=h._index,s=u.options.resolve,l=f.parseFont(s([r.font,{}],e,o)),c=s([r.color,n.defaults.global.defaultFontColor],e,o);return{align:s([r.align,"center"],e,o),anchor:s([r.anchor,"center"],e,o),area:e.chart.chartArea,backgroundColor:s([r.backgroundColor,null],e,o),borderColor:s([r.borderColor,null],e,o),borderRadius:s([r.borderRadius,0],e,o),borderWidth:s([r.borderWidth,0],e,o),clamp:s([r.clamp,!1],e,o),clip:s([r.clip,!1],e,o),color:c,display:t,font:l,lines:i,offset:s([r.offset,0],e,o),opacity:s([r.opacity,1],e,o),origin:ct(h._el),padding:u.options.toPadding(s([r.padding,0],e,o)),positioner:lt(h._el),rotation:s([r.rotation,0],e,o)*(Math.PI/180),size:f.textSize(h._ctx,i,l),textAlign:s([r.textAlign,"start"],e,o),textShadowBlur:s([r.textShadowBlur,0],e,o),textShadowColor:s([r.textShadowColor,c],e,o),textStrokeColor:s([r.textStrokeColor,c],e,o),textStrokeWidth:s([r.textStrokeWidth,0],e,o)}},update:function(n){var t=this,i=null,h=null,c=t._index,r=t._config,e,o,s,l=u.options.resolve([r.display,!0],n,c);l&&(e=n.dataset.data[c],o=u.valueOrDefault(u.callback(r.formatter,[e,n]),e),s=u.isNullOrUndef(o)?[]:f.toTextLines(o),s.length&&(i=t._modelize(l,s,r,n),h=ht(i)));t._model=i;t._rects=h},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(n,t){var o=this,r=n.ctx,u=o._model,s=o._rects,e;this.visible()&&(r.save(),u.clip&&(e=u.area,r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()),r.globalAlpha=f.bound(0,u.opacity,1),r.translate(i(t.x),i(t.y)),r.rotate(u.rotation),at(r,s.frame,u),pt(r,u.lines,s.text,u),r.restore())}});var wt=n.helpers,bt=Number.MIN_SAFE_INTEGER||-9007199254740991,kt=Number.MAX_SAFE_INTEGER||9007199254740991;p=function(){this._rotation=0;this._rect={x:0,y:0,w:0,h:0}};wt.extend(p.prototype,{center:function(){var n=this._rect;return{x:n.x+n.w/2,y:n.y+n.h/2}},update:function(n,t,i){this._rotation=i;this._rect={x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}},contains:function(n){var r=this,i=1,t=r._rect;return n=e(n,r.center(),-r._rotation),!(n.x<t.x-i||n.y<t.y-i||n.x>t.x+t.w+i*2||n.y>t.y+t.h+i*2)},intersects:function(n){var t=this._points(),i=n._points(),u=[l(t[0],t[1]),l(t[0],t[3])],r,f,e;for(this._rotation!==n._rotation&&u.push(l(i[0],i[1]),l(i[0],i[3])),r=0;r<u.length;++r)if(f=rt(t,u[r]),e=rt(i,u[r]),f.max<e.min||e.max<f.min)return!1;return!0},_points:function(){var r=this,n=r._rect,t=r._rotation,i=r.center();return[e({x:n.x,y:n.y},i,t),e({x:n.x+n.w,y:n.y},i,t),e({x:n.x+n.w,y:n.y+n.h},i,t),e({x:n.x,y:n.y+n.h},i,t)]}});var o={prepare:function(n){for(var r=[],i,e,u,t=0,f=n.length;t<f;++t)for(i=0,e=n[t].length;i<e;++i)u=n[t][i],r.push(u),u.$layout={_box:new p,_hidable:!1,_visible:!0,_set:t,_idx:i};return r.sort(function(n,t){var i=n.$layout,r=t.$layout;return i._idx===r._idx?i._set-r._set:r._idx-i._idx}),this.update(r),r},update:function(n){for(var f=!1,i,u,r,t=0,e=n.length;t<e;++t)i=n[t],u=i.model(),r=i.$layout,r._hidable=u&&u.display==="auto",r._visible=i.visible(),f|=r._hidable;f&&gt(n)},lookup:function(n,t){for(var r,i=n.length-1;i>=0;--i)if(r=n[i].$layout,r&&r._visible&&r._box.contains(t))return{dataset:r._set,label:n[i]};return null},draw:function(n,t){for(var i,u,f,e,r=0,o=t.length;r<o;++r)i=t[r],u=i.$layout,u._visible&&(f=i.geometry(),e=ut(i._el._view,i.model(),f),u._box.update(e,f,i.rotation()),i.draw(n,e))}},a=n.helpers,ft={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:undefined,display:!0,font:{family:undefined,lineHeight:1.2,size:undefined,style:undefined,weight:null},formatter:function(n){if(a.isNullOrUndef(n))return null;var i=n,r,u,t;if(a.isObject(n))if(a.isNullOrUndef(n.label))if(a.isNullOrUndef(n.r))for(i="",r=Object.keys(n),t=0,u=r.length;t<u;++t)i+=(t!==0?", ":"")+r[t]+": "+n[r[t]];else i=n.r;else i=n.label;return""+i},listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:undefined,textStrokeWidth:0,textShadowBlur:0,textShadowColor:undefined},w=n.helpers,t="$datalabels";return n.defaults.global.plugins.datalabels=ft,n.defaults.global.plugins.datalabels=ft,k={id:"datalabels",beforeInit:function(n){n[t]={_actives:[]}},beforeUpdate:function(n){var i=n[t];i._listened=!1;i._listeners={};i._datasets=[];i._labels=[]},afterDatasetUpdate:function(n,i,r){var o=i.index,s=n[t],v=s._datasets[o]=[],p=n.isDatasetVisible(o),c=n.data.datasets[o],l=ni(c,r),a=i.meta.data||[],b=a.length,h=n.ctx,u,f,e;for(h.save(),u=0;u<b;++u)f=a[u],p&&f&&!f.hidden&&!f._model.skip?(v.push(e=new y(l,h,f,u)),e.update(e.$context={active:!1,chart:n,dataIndex:u,dataset:c,datasetIndex:o})):e=null,f[t]=e;h.restore();w.merge(s._listeners,l.listeners||{},{merger:function(n,t,r){t[n]=t[n]||{};t[n][i.index]=r[n];s._listened=!0}})},afterUpdate:function(n,i){n[t]._labels=o.prepare(n[t]._datasets,i)},afterDatasetsDraw:function(n){o.draw(n,n[t]._labels)},beforeEvent:function(n,i){if(n[t]._listened)switch(i.type){case"mousemove":case"mouseout":ii(n,i);break;case"click":ri(n,i)}},afterEvent:function(n){for(var i=n[t],c=i._actives,l=i._actives=n.lastActive||[],s=f.arrayDiff(c,l),e,r,u=0,h=s.length;u<h;++u)e=s[u],e[1]&&(r=e[0][t],r&&(r.$context.active=e[1]===1,r.update(r.$context)));(i._dirty||s.length)&&(o.update(i._labels),n.animating||n.render());delete i._dirty}},n.plugins.register(k),k});